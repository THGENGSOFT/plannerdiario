<!DOCTYPE html5>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Planner Di√°rio</title>
  <!-- SheetJS para gera√ß√£o de Excel -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <h1>Planner Di√°rio</h1>
  <p id="dataAtual"></p>

  <label>
    Nome:
    <input type="text" id="inputNome" placeholder="Digite seu nome" />
  </label>
  <label>
    Loja/Unidade:
    <input type="text" id="inputLoja" placeholder="Digite o nome da loja" />
  </label>
  <button id="btnGerar">Iniciar Planejamento</button>

  <div id="planejamento" style="display:none;"></div>

  <script>
    // Configura√ß√£o de locale para portugu√™s
    const formatoPortugues = { weekday: 'long', year: 'numeric', month: '2-digit', day: '2-digit' };

    function obterData() {
      const hoje = new Date();
      const partes = new Intl.DateTimeFormat('pt-BR', formatoPortugues).formatToParts(hoje);
      const diaSemana = partes.find(p => p.type === 'weekday').value;
      const dia = partes.find(p => p.type === 'day').value;
      const mes = partes.find(p => p.type === 'month').value;
      const ano = partes.find(p => p.type === 'year').value;
      return `${diaSemana.charAt(0).toUpperCase()}${diaSemana.slice(1)}, ${dia}/${mes}/${ano}`;
    }

    // Exporta dados para Excel
    function exportarParaExcel(dados, nomeLoja) {
      const hoje = new Date().toISOString().slice(0,10);
      const header = [[ nomeLoja.toUpperCase(), hoje ]];
      const rows = Object.entries(dados).map(([k,v]) => [k, v]);
      const ws = XLSX.utils.aoa_to_sheet([ ...header, ...rows ]);
      const wb = XLSX.utils.book_new();
      XLSX.utils.book_append_sheet(wb, ws, 'Dados');
      XLSX.writeFile(wb, `DIARIO_${nomeLoja.toUpperCase()}_${hoje}.xlsx`);
    }

    // Gera formul√°rio de indicadores e adiciona bot√£o de exporta√ß√£o
    function coletarDadosOperacionais(nomeLoja) {
      const percentuais = [
        "NPS", "Improdutivo", "Abertura Tablet",
        "Encerramento Tablet", "% Recupera√ß√£o de Avarias",
        "Ocupa√ß√£o do Dia", "Ocupa√ß√£o Acumulada"
      ];
      const inteiros = [ "Reservas do Dia", "Devolu√ß√µes do Dia" ];
      const titulos = [ ...percentuais, ...inteiros ];

      const container = document.getElementById('formIndicadores');
      container.innerHTML = '<h3>üìä Coleta de Indicadores</h3>';

      titulos.forEach(t => {
        const safe = t.replace(/[^a-zA-Z0-9]/g, '_');
        const placeholder = percentuais.includes(t) ? 'Ex: 12.34' : 'Ex: 123';
        const div = document.createElement('div');
        div.innerHTML = `<label>${t}: <input type="number" id="inp_${safe}" placeholder="${placeholder}" step="any"/></label>`;
        container.appendChild(div);
      });

      const btn = document.createElement('button');
      btn.type = 'button';
      btn.textContent = 'Exportar para Excel';
      btn.onclick = () => {
        const dados = {};
        titulos.forEach(t => {
          const safe = t.replace(/[^a-zA-Z0-9]/g, '_');
          let v = parseFloat(document.getElementById(`inp_${safe}`).value) || 0;
          if (percentuais.includes(t)) dados[t] = v.toFixed(2).replace('.', ',') + '%';
          else dados[t] = parseInt(v, 10);
        });
        exportarParaExcel(dados, nomeLoja);
      };
      container.appendChild(btn);
    }

    // Fun√ß√£o principal de planejamento
    function gerarPlanejamento() {
      const nome = document.getElementById('inputNome').value.trim();
      const loja = document.getElementById('inputLoja').value.trim();
      if (!nome || !loja) { alert('Por favor, preencha nome e loja.'); return; }

      document.getElementById('dataAtual').textContent = obterData();
      const plano = document.getElementById('planejamento');
      plano.style.display = 'block';

      plano.innerHTML = `
        <h2>üë§ Gestor ${nome} | üè¢ RAC ${loja}</h2>
        <br/>
        <h3>üïó Bom dia!</h3>
        <ul>
          <li>Acompanhar NextManager</li>
          <li>Conferir Calend√°rios e Lembretes</li>
          <li>Conferir agendamentos de CPA</li>
          <li>Liberar lavagens e abastecimentos</li>
          <li>Verificar Previs√£o de Ocupa√ß√£o por Loja e grupos especiais</li>
          <li>Conferir limpeza da loja, mobil√°rios e marketing</li>
          <li>Conferir limpeza das Vans</li>
          <li>Conferir e enviar indicadores do dia</li>
        </ul>
        <p>
          <a href="https://manager.nextqs.com/login.html" target="_blank">NextManager</a> |
          <a href="https://vetorzkm.movida.com.br/login.php" target="_blank">Vetor</a> |
          <a href="https://app.powerbi.com/home?experience=power-bi" target="_blank">Power¬†BI</a> |
          <a href="https://outlook.office365.com/mail/inbox" target="_blank">E-mail</a> |
          <a href="https://www.notion.so/" target="_blank">Notion</a> |
          <a href="https://plataforma.ticketlog.com.br/" target="_blank">Ticket¬†Log</a> |
          <a href="https://acesso.movidacloud.com.br/" target="_blank">JIRA</a> |
          <a href="https://webantifraudes.b2egroup.com.br/Web/Usuario/Login?url=~/?" target="_blank">B2E</a> |
          <a href="https://simpar.docnix.com.br/docnix/corporate/index.html#/" target="_blank">Docnix</a>
        </p>
        <br/>
        <div id="formIndicadores"></div>
        <div>
        <br/>
          <h3>üöó Acompanhamento da Frota</h3>
          <ul>
            <li>Verificar ve√≠culos sem movimenta√ß√£o h√° mais de 3 dias</li>
            <li>Cobrar retorno dos ve√≠culos em status Improdutivo/Manuten√ß√£o/N√£o Operacional</li>
            <li>Conferir manuten√ß√£o em geral, limpeza, luzes de alertas e comunica√ß√£o visual (chaveiros, lixeiras, porta documentos e adesivos)</li>
            <li>Direcionar ve√≠culos com manuten√ß√£o pendente</li>
          </ul>
          <p>
            <a href="https://sistemas.infornet.com.br/webassist/movida/index.php" target="_blank">Web Assist</a> |
            <a href="https://geo.satrastreamento.com.br/" target="_blank">Geo</a>
          </p>
        </div>
        <br/>
        <div>
          <h3>ü´Ç Gest√£o de Gente</h3>
          <ul>
            <li>Conferir Escalas e Intervalos</li>
            <li>Alinhar com a equipe sobre objetivos di√°rios</li>
            <li>Refor√ßar a import√¢ncia do NPS e produtividade</li>
            <li>Realizar feedbacks</li>
            <li>Refor√ßar a import√¢ncia do uso dos uniformes / EPIs</li>
            <li>Refor√ßar a import√¢ncia do uso do tablet</li>
          </ul>
          <p>
            <a href="https://colaborador.simpar.com.br/irj/portal" target="_blank">Portal do Colaborador</a> |
            <a href="https://jornadas.escala.app/login" target="_blank">Jornada Escalas</a> |
            <a href="https://peexbrasil.com.br/gruposimpar/" target="_blank">Ciclo de Gente</a>
          </p>
        </div>
        <br/>
        <div>
          <h3>üìÖ Planejamento do Dia Seguinte</h3>
          <ul>
            <li>Definir prioridades para o dia seguinte</li>
          </ul>
          <p>
            <a href="https://universidadesimpar.skore.io/login" target="_blank">Universidade Simpar</a>
          </p>
        </div>
        <br/>
        <div>
          <h3>üí° Dicas</h3>
          <ul>
            <li>Comece o dia com caf√© ‚òï</li>
            <li>Mantenha o foco</li>
            <li>Revisite indicadores do m√™s anterior</li>
            <li>Comunica√ß√£o √© a chave</li>
          </ul>
          <p>
            <a href="https://www.movida.com.br/contrato/" target="_blank">Contrato P√∫blico</a>
          </p>
        </div>
      `;

      coletarDadosOperacionais(loja);
    }

    // Inicializa√ß√£o
    document.getElementById('btnGerar').addEventListener('click', gerarPlanejamento);
    document.getElementById('dataAtual').textContent = obterData();
  </script>
</body>
</html>
<footer style="text-align:center; font-size:0.5rem; margin-top:2rem;">
  ¬©¬†2025 <a href="https://thiagosilva.dev">Thiago Fagundes</a>. Todos os direitos reservados.
</footer>
